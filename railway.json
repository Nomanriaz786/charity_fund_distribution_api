{
  "services": [
    {
      "name": "charitydb",
      "build": {
        "dockerfilePath": "./Dockerfile.db"
      },
      "deploy": {
        "restartPolicyType": "on_failure",
        "healthcheckPath": "/",
        "healthcheckTimeout": 300
      },
      "env": {
        "ACCEPT_EULA": "Y",
        "MSSQL_PID": "Express",
        "SA_PASSWORD": "${{ secrets.DB_PASSWORD }}",
        "MSSQL_USER": "mssql"
      }
    },
    {
      "name": "charityweb",
      "build": {
        "dockerfilePath": "./Dockerfile.web"
      },
      "deploy": {
        "command": "dotnet Charity_Fundraising_DBMS.dll",
        "restartPolicyType": "on_failure",
        "healthcheckPath": "/health",
        "dependsOn": ["charitydb"]
      },
      "ports": ["80:80"],
      "env": {
        "ASPNETCORE_ENVIRONMENT": "Development",
        "DB_SERVER": "${{ services.charitydb.host }}:${{ services.charitydb.port }}",
        "DB_NAME": "Charity_Fundraising_DBMS",
        "DB_USER": "sa",
        "DB_PASSWORD": "${{ secrets.DB_PASSWORD }}",
        "TrustServerCertificate": "true",
        "ConnectionRetryCount": "10",
        "ConnectionRetryDelay": "10",
        "ConnectionStrings__DefaultConnection": "Server=${{ services.charitydb.host }};Database=Charity_Fundraising_DBMS;User Id=sa;Password=${{ secrets.DB_PASSWORD }};TrustServerCertificate=True;"
      }
    }
  ],
  "volumes": {
    "sqldata": {
      "mountPath": "/var/opt/mssql"
    }
  }
}